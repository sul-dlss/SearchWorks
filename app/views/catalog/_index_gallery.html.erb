<%
  counter = document_counter_with_offset(document_counter)
  preview_container = 'preview-container-' + document.id
%>

<div class="gallery-document" <%= preview_data_attrs("preview-gallery", document[:id], ".#{preview_container}") %> data-preview-in-gallery="true" data-doc-id=<%= document.id %> >
  <div class="item-thumb">
    <%= render Blacklight::Document::ThumbnailComponent.new(counter:, document:) %>
  </div>
  <div class="caption">
    <% doc_presenter = document_presenter(document) %>
    <% # header bar for doc items in index view gallery %>
    <div class="documentHeader">
      <div class="callnumber-bar">
        <% if document.items.present? %>
          <%= document.preferred_item.callnumber %><br/>
          <% if document.holdings.libraries.length == 1 %>
            <%= document.holdings.libraries.first.name %>
          <% else %>
            in <%= document.holdings.libraries.length %> libraries
          <% end %>
        <% elsif document.mods? %>
          <br/>Stanford Digital Repository
        <% elsif document.preferred_online_links.present?  %>
          eResource<br />
          <%= document.eresources_library_display_name || 'Stanford Libraries' %>
        <% end %>
      </div>
      <h3 class="index_title">
        <% counter = document_counter_with_offset(document_counter) %>
        <span class="three-lines">
          <%= render_resource_icon doc_presenter.formats %>
          <%= document.online_label %>
          <%= link_to_document document, counter: counter %>
        </span>
        <span class="main-title-date"><%= get_main_title_date(document) %></span>
      </h3>
    </div>
  </div>
  <% # bookmark functions for items/docs and preview button %>
  <div class="gallery-buttons">
    <button class="btn btn-xs btn-preview preview-button docid-<%= document.id %>" data-behavior="preview-button-trigger">Preview</button>
    <%= render_index_doc_actions document, :wrapping_class => "index-document-functions" %>
  </div>
</div>
<div class="<%= preview_container %> preview-container" data-document-id="<%= document[:id] %>"></div>
