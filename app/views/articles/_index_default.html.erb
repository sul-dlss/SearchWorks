<% doc_presenter = presenter(document) %>
<ul class='document-metadata dl-horizontal dl-invert'>
  <% if document['eds_authors'].present? %>
    <li>
      <div data-behavior='article-metadata-truncate'>
        <%= doc_presenter.field_value('eds_authors') %>
      </div>
    </li>
  <% end %>

  <% if document['eds_composed_title'].present? %>
    <li><%= doc_presenter.field_value('eds_composed_title') %></li>
  <% end %>
</ul>

<% if document.eds_subjects.present? || document['eds_abstract'].present? %>
  <dl class="document-metadata dl-horizontal dl-invert article-metadata">
    <% if document.eds_subjects.present? %>
      <dt>Subjects</dt>
      <dd>
        <div data-behavior='article-metadata-truncate'>
          <%= document.eds_subjects.map(&:to_s).to_sentence.html_safe %>
        </div>
      </dd>
    <% end %>

    <% if document['eds_abstract'].present? %>
      <dt>Abstract</dt>
      <dd>
        <div data-behavior='article-metadata-truncate'>
          <%= doc_presenter.field_value('eds_abstract') %>
        </div>
      </dd>
    <% end %>
  </dl>
<% end %>

<% if !document.eds_restricted? %>
  <ul class='document-metadata dl-horizontal dl-invert'>
    <% if document.access_panels.online? %>
      <% document.access_panels.online.links.each do |link| %>
        <li>
          <% if link.ill? -%>
            <%= link_to(link.text, link.href, class: 'sfx') %>
          <% else %>
            <span class="online-label">Full text</span>
            <%= link_to(link.text, link.href) %>
          <% end %>
        </li>
      <% end %>
    <% elsif document.html_fulltext? %>
      <li>
        <% if link.href == 'detail' %>
          <span class="online-label">Full text</span>
          <%= link_to('View on detail page',article_path(document)) unless !document.html_fulltext? %>
          <%= image_tag("pdf-icon.svg", height: "20px", alt: "PDF") %>
          <%= link_to(link.text, article_fulltext_link_path(id: document.id, type: link.type), data: { 'turbolinks' => false }) %>
        <% elsif link.ill? -%>
          <%= link_to(link.text, link.href, class: 'sfx') %>
        <% else %>
          <span class="online-label">Full text</span>
          <%= link_to(link.text, link.href) %>
        <% end %>
        </li>
      <% end %>
    <% elsif document.html_fulltext? # HTML fulltext only %>
      <li>
        <span class="online-label">Full text</span>
        <%= link_to('View on detail page',article_path(document)) %>
      </li>
    <% end %>
  </ul>
<% end %>
