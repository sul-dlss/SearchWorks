<%= form_with url: feedback_form_path, method: :post, class: "feedback-form", role: "form", namespace: type do |f| %>
  <%= f.hidden_field :url, value: request.referer, class:"reporting-from-field" %>
  <%= f.hidden_field :user_agent %>
  <%= f.hidden_field :viewport %>
  <%= f.hidden_field :last_search %>
  <div class="col-sm-8 offset-sm-1">
    <% if type == 'connection' %>
      <%= f.hidden_field :type, value: type %>
      <div class="form-group row ">
        <%= f.label(:resource_name, 'Name of resource', class:"col-sm-3 col-form-label text-right") %>
        <div class="col-sm-9">
          <%= f.text_field :resource_name, value: "", class:"form-control", required: true %>
        </div>
      </div>
      <div class="form-group row">
        <%= f.label(:problem_url, 'Problem URL', class:"col-sm-3 col-form-label text-right") %>
        <div class="col-sm-9">
          <%= f.text_field :problem_url, value: "", class:"form-control", required: true %>
        </div>
      </div>
      <div class="form-group row">
        <%= f.label(:message, 'Describe the connection issue', class:"col-sm-3 col-form-label text-right") %>
        <div class="col-sm-9">
          <%= f.text_area :message, value: "", rows:"5", class:"form-control", required: true %>
        </div>
      </div>
    <% else %>
      <div class="form-group row">
        <%= f.label(:message, 'Message', class:"col-sm-3 col-form-label text-right") %>
        <div class="col-sm-9">
          <%= f.text_area :message, value: "", rows:"5", class:"form-control", required: true %>
        </div>
      </div>
    <% end %>
    <div class="form-group row">
      <%= f.label(:name, 'Your name', class:"col-sm-3 col-form-label text-right") %>
      <div class="col-sm-9">
        <%= f.text_field :name, value: "", class:"form-control", autocomplete: "name", required: true %>
      </div>
    </div>
    <div class="form-group row">
      <%= f.label(:to, 'Your email', class:"col-sm-3 col-form-label text-right") %>
      <div class="col-sm-9">
        <%= f.email_field :to, value: "", class:"form-control", autocomplete: "email", required: true %>
      </div>
    </div>

    <% if current_user.blank? %>
      <div class="form-group row">
        <div class="col-sm-9 offset-sm-3">
          <%# Remove noscript for recaptcha. See https://github.com/sul-dlss/SearchWorks/issues/3873 %>
          <%= recaptcha_tags id: "#{type}-recaptcha", noscript: false %>

          <p>(Stanford users can avoid this Captcha by logging in.)</p>
        </div>
      </div>
    <% end %>

    <div class="form-group row">
      <div class="offset-sm-3 col-sm-9">
        <button type="submit" class="btn btn-primary">Send</button>
        <%= link_to "Cancel", :back, class:"cancel-link", data: { toggle: 'collapse', target: target } %>
      </div>
    </div>
  </div>
<% end %>
