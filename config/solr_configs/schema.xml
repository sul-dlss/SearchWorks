<?xml version="1.0" encoding="UTF-8" ?>
<schema name="Stanford Searchworks" version="1.5">
  <uniqueKey>id</uniqueKey>
  <similarity class="solr.ClassicSimilarityFactory"/>

  <fields>
    <!-- needed by some of Solr 4.0 functionality like transaction log or partial documents update -->
    <field name="_version_" type="long" indexed="true" stored="true" />

    <field name="id" type="string" indexed="true" stored="true" required="true" docValues="true" />
    <field name="id_search" type="string_punct_stop" indexed="true" stored="false" />
    <field name="timestamp" type="date" indexed="true" stored="true" default="NOW/SECOND" docValues="true" />
    <field name="created" type="date" indexed="true" stored="true" default="NOW/SECOND" docValues="true" />
    <field name="last_updated" type="date" indexed="true" stored="true" default="NOW/SECOND" docValues="true" />
    <!-- entire marc bib record -->
    <field name="marcxml" type="string" indexed="false" stored="true" large="true" />
    <!-- all_search: catch-all field for searchable text; stored for hit highlighting />-->
    <field name="all_search" type="text" indexed="true" stored="true" termVectors="true" termPositions="true" termOffsets="true"/>
    <field name="all_unstem_search" type="textNoStem" indexed="true" stored="false" />
    <field name="vern_all_search" type="text" indexed="true" stored="true" />

    <field name="bib_search" type="text" indexed="true" stored="true" termVectors="true" termPositions="true" termOffsets="true"/>
    <field name="bib_unstem_search" type="textNoStem" indexed="true" stored="false" />
    <field name="vern_bib_search" type="text" indexed="true" stored="true" />

    <!-- Format Field: facet and display
      (deprecated in favor of format_main_ssim, left for continuity in UI URLs for old formats) -->
    <field name="format" type="string" indexed="true" stored="true" multiValued="true" />

    <!-- Language Field: facet and display -->
    <field name="language" type="string" indexed="true" stored="true" multiValued="true" />

    <!-- Standard Number Fields -->
    <!-- allow end users to search our index by ISBN and ISSN; more values than display isbn/issn.-->
    <!-- isbn_search is type text to accommodate hyphens that could be entered by end users -->
    <field name="isbn_search" type="text" indexed="true" stored="true" multiValued="true" omitNorms="true" />
    <!-- text for issn to accommodate hyphen present or not -->
    <field name="issn_search" type="text" indexed="true" stored="true" multiValued="true" omitNorms="true"/>
    <!-- display fields to allow external lookups (e.g. Google book search, xISBN, xISSN ...) -->
    <field name="isbn_display" type="string" indexed="false" stored="true" multiValued="true" />
    <field name="issn_display" type="string" indexed="false" stored="true" multiValued="true" />
    <field name="lccn" type="string" indexed="false" stored="true" />
    <field name="oclc" type="string_punct_stop" indexed="true" stored="true" multiValued="true" />

    <!-- Title Search Fields -->
    <field name="title_245a_exact_search" type="text_anchored" indexed="true" stored="false" />
    <field name="title_245a_search" type="text" indexed="true" stored="true" />
    <field name="vern_title_245a_search" type="textNoStem" indexed="true" stored="true" />
    <field name="title_245a_unstem_search" type="textNoStem" indexed="true" stored="false" />
    <field name="title_245_search" type="text" indexed="true" stored="true" />
    <field name="vern_title_245_search" type="textNoStem" indexed="true" stored="true" />
    <field name="title_245_unstem_search" type="textNoStem" indexed="true" stored="false" />
    <field name="title_uniform_search" type="text" indexed="true" stored="true" />
    <field name="vern_title_uniform_search" type="textNoStem" indexed="true" stored="true" />
    <field name="title_uniform_unstem_search" type="textNoStem" indexed="true" stored="false" />
    <field name="title_variant_search" type="text" indexed="true" stored="true" multiValued="true" />
    <field name="vern_title_variant_search" type="textNoStem" indexed="true" stored="true" multiValued="true" />
    <field name="title_variant_unstem_search" type="textNoStem" indexed="true" stored="false" multiValued="true" />
    <field name="title_related_search" type="text" indexed="true" stored="true" multiValued="true" />
    <field name="vern_title_related_search" type="textNoStem" indexed="true" stored="true" multiValued="true" />
    <field name="title_related_unstem_search" type="textNoStem" indexed="true" stored="false" multiValued="true" />

    <!-- Title Display fields -->
    <field name="title_display" type="string" indexed="false" stored="true" />
    <field name="vern_title_display" type="string" indexed="false" stored="true" />
    <field name="title_245a_display" type="string" indexed="false" stored="true" />
    <field name="vern_title_245a_display" type="string" indexed="false" stored="true" />
    <field name="title_245c_display" type="string" indexed="false" stored="true" />
    <field name="vern_title_245c_display" type="string" indexed="false" stored="true" />
    <field name="title_full_display" type="string" indexed="false" stored="true" />
    <field name="vern_title_full_display" type="string" indexed="false" stored="true" />
    <field name="title_uniform_display" type="string" indexed="false" stored="true" />
    <field name="vern_title_uniform_display" type="string" indexed="false" stored="true" />
    <field name="title_variant_display" type="string" indexed="false" stored="true" multiValued="true" />

    <field name="title_sort" type="alphaSort" indexed="true" stored="true" />

    <!-- Series Search Fields -->
    <field name="series_exact_search" type="text_anchored" indexed="true" stored="false" multiValued="true" />
    <field name="series_search" type="text" indexed="true" stored="true" multiValued="true" />
    <field name="vern_series_search" type="textNoStem" indexed="true" stored="true" multiValued="true" />
    <field name="series_unstem_search" type="textNoStem" indexed="true" stored="false" multiValued="true" />

    <!-- Author Title Search Fields -->
    <field name="author_title_245ac_search" type="text" indexed="true" stored="true" multiValued="true" />
    <field name="author_title_245ac_unstem_search" type="text" indexed="true" stored="false" multiValued="true" />
    <field name="vern_author_title_245ac_search" type="textNoStem" indexed="true" stored="true" multiValued="true" />
    <field name="author_title_1xx_search" type="text" indexed="true" stored="true" multiValued="true" />
    <field name="author_title_1xx_unstem_search" type="text" indexed="true" stored="false" multiValued="true" />
    <field name="vern_author_title_1xx_search" type="text" indexed="true" stored="true" multiValued="true" />
    <field name="author_title_search" type="text" indexed="true" stored="true" multiValued="true" />
    <field name="author_title_unstem_search" type="text" indexed="true" stored="false" multiValued="true" />

    <!-- Author Search Fields -->
    <field name="author_1xx_search" type="text" indexed="true" stored="true" />
    <field name="vern_author_1xx_search" type="textNoStem" indexed="true" stored="true" />
    <field name="author_1xx_unstem_search" type="textNoStem" indexed="true" stored="false" />
    <field name="author_7xx_search" type="text" indexed="true" stored="true" multiValued="true" />
    <field name="vern_author_7xx_search" type="textNoStem" indexed="true" stored="true" multiValued="true" />
    <field name="author_7xx_unstem_search" type="textNoStem" indexed="true" stored="false" multiValued="true" />
    <field name="author_8xx_search" type="text" indexed="true" stored="true" multiValued="true" />
    <field name="vern_author_8xx_search" type="textNoStem" indexed="true" stored="true" multiValued="true" />
    <field name="author_8xx_unstem_search" type="textNoStem" indexed="true" stored="false" multiValued="true" />

    <!-- Author Facet Fields -->
    <field name="author_person_facet" type="string" indexed="true" stored="true" multiValued="true" />
    <field name="author_other_facet" type="string" indexed="true" stored="true" multiValued="true" />

    <field name="author_sort" type="alphaSort" indexed="true" stored="true" />

    <!-- Author Display Fields -->
    <field name="author_person_display" type="string" indexed="false" stored="true" multiValued="true" />
    <field name="vern_author_person_display" type="string" indexed="false" stored="true" />
    <field name="author_person_full_display" type="string" indexed="false" stored="true" multiValued="true" />
    <field name="vern_author_person_full_display" type="string" indexed="false" stored="true" />
    <field name="author_corp_display" type="string" indexed="false" stored="true" multiValued="true"/>
    <field name="vern_author_corp_display" type="string" indexed="false" stored="true" />
    <field name="author_meeting_display" type="string" indexed="false" stored="true" multiValued="true"/>
    <field name="vern_author_meeting_display" type="string" indexed="false" stored="true" />

    <!--  Subject Search Fields -->
    <field name="topic_search" type="text" indexed="true" stored="true" multiValued="true" />
    <field name="vern_topic_search" type="textNoStem" indexed="true" stored="true" multiValued="true" />
    <field name="topic_unstem_search" type="textNoStem" indexed="true" stored="false" multiValued="true" />
    <field name="topic_subx_search" type="text" indexed="true" stored="true" multiValued="true" />
    <field name="vern_topic_subx_search" type="textNoStem" indexed="true" stored="true" multiValued="true" />
    <field name="topic_subx_unstem_search" type="textNoStem" indexed="true" stored="false" multiValued="true" />
    <field name="geographic_search" type="text" indexed="true" stored="true" multiValued="true" />
    <field name="vern_geographic_search" type="textNoStem" indexed="true" stored="true" multiValued="true" />
    <field name="geographic_unstem_search" type="textNoStem" indexed="true" stored="false" multiValued="true" />
    <field name="geographic_subz_search" type="text" indexed="true" stored="true" multiValued="true" />
    <field name="vern_geographic_subz_search" type="textNoStem" indexed="true" stored="true" multiValued="true" />
    <field name="geographic_subz_unstem_search" type="textNoStem" indexed="true" stored="false" multiValued="true" />
    <field name="subject_other_search" type="text" indexed="true" stored="true" multiValued="true" />
    <field name="vern_subject_other_search" type="textNoStem" indexed="true" stored="true" multiValued="true" />
    <field name="subject_other_unstem_search" type="textNoStem" indexed="true" stored="false" multiValued="true" />
    <field name="subject_other_subvy_search" type="text" indexed="true" stored="true" multiValued="true" />
    <field name="vern_subject_other_subvy_search" type="textNoStem" indexed="true" stored="true" multiValued="true" />
    <field name="subject_other_subvy_unstem_search" type="textNoStem" indexed="true" stored="false" multiValued="true" />
    <field name="subject_all_search" type="text" indexed="true" stored="true" multiValued="true" />
    <field name="vern_subject_all_search" type="textNoStem" indexed="true" stored="true" multiValued="true" />
    <field name="subject_all_unstem_search" type="textNoStem" indexed="true" stored="false" multiValued="true" />

    <field name="db_az_subject" type="string" indexed="true" stored="true" multiValued="true" />
    <field name="db_az_subject_search" type="text" indexed="true" stored="true" multiValued="true" />

    <!-- Subject Facet Fields -->
    <field name="topic_facet" type="string" indexed="true" stored="true" multiValued="true" />
    <field name="geographic_facet" type="string" indexed="true" stored="true" multiValued="true" />
    <field name="era_facet" type="string" indexed="true" stored="true" multiValued="true" />

    <!-- Subject Display Fields -->
    <field name="topic_display" type="string" indexed="false" stored="true" multiValued="true" />
    <field name="subject_other_display" type="string" indexed="false" stored="true" multiValued="true" />

    <!-- Publishing Fields -->
    <field name="pub_search" type="text" indexed="true" stored="true" omitNorms="true" multiValued="true"/>
    <field name="vern_pub_search" type="textNoStem" indexed="true" stored="true" omitNorms="true" multiValued="true"/>
    <field name="pub_country" type="text" indexed="true" stored="true" omitNorms="true"/>
    <!-- TODO: should pub_date_search be a date or a text field? -->
    <field name="pub_date_search" type="text" indexed="true" stored="true" omitNorms="true"/>
    <field name="pub_date_sort" type="alphaSort" indexed="true" stored="true" />
    <!-- Pub Date Facet Fields -->
    <!-- pub_date was facet and display, now deprecated -->
    <field name="pub_date" type="string" indexed="true" stored="true" />
    <field name="pub_year_tisim" type="tint" indexed="true" stored="true" multiValued="true" docValues="true" />
    <field name="pub_display" type="string" indexed="false" stored="true" multiValued="true"/>
    <!-- pub_date_display can be removed after all DOR objects reindexed in Feb/March 2016 -->
    <field name="pub_date_display" type="string" indexed="false" stored="true"/>
    <field name="imprint_display" type="string" indexed="false" stored="true" multiValued="true"/>

    <!-- Date Cataloged for new items feed -->
    <field name="date_cataloged" type="date" indexed="true" stored="true" docValues="true" />

    <!-- URL Fields -->
    <field name="url_fulltext" type="string" indexed="false" stored="true" multiValued="true"/>
    <field name="url_suppl" type="string" indexed="false" stored="true" multiValued="true"/>
    <!-- sfx urls should rarely occur more than once in a marc bib record -->
    <field name="url_sfx" type="string" indexed="false" stored="true" multiValued="true" />
    <field name="url_restricted" type="string" indexed="false" stored="true" multiValued="true" />
    <field name="managed_purl_urls" type="string" indexed="true" stored="true" multiValued="true" docValues="true" />

    <!-- Physical Fields -->
    <field name="physical" type="text" indexed="true" stored="true" multiValued="true" />
    <field name="vern_physical" type="textNoStem" indexed="true" stored="true" multiValued="true" />

    <!-- Table of Contents -->
    <field name="toc_search" type="text" indexed="true" stored="true" multiValued="true" />
    <field name="vern_toc_search" type="textNoStem" indexed="true" stored="true" multiValued="true" />
    <field name="toc_unstem_search" type="textNoStem" indexed="true" stored="false" multiValued="true" />
    <!-- Context -->
    <field name="context_search" type="text" indexed="true" stored="true" multiValued="true" />
    <field name="vern_context_search" type="textNoStem" indexed="true" stored="true" multiValued="true" />
    <field name="context_unstem_search" type="textNoStem" indexed="true" stored="false" multiValued="true" />
    <!-- Summary -->
    <field name="summary_search" type="text" indexed="true" stored="true" multiValued="true" />
    <field name="vern_summary_search" type="textNoStem" indexed="true" stored="true" multiValued="true" />
    <field name="summary_unstem_search" type="textNoStem" indexed="true" stored="false" multiValued="true" />
    <field name="summary_display" type="string" indexed="false" stored="true" multiValued="true" />
    <!-- Award -->
    <field name="award_search" type="text" indexed="true" stored="true" multiValued="true" />

    <!-- Item Info Fields (derived from 999) -->
    <!-- Call Number Fields -->
    <field name="callnum_search" type="callnum_ws" indexed="true" stored="true" multiValued="true"/>

    <!-- for nearby on shelf:  term lookups to get next X alpha sorted terms -->
    <field name="shelfkey" type="alphaSort" indexed="true" stored="true" multiValued="true" />
    <field name="reverse_shelfkey" type="alphaSort" indexed="true" stored="true" multiValued="true" />

    <field name="barcode_search" type="string" indexed="true" stored="true" multiValued="true" docValues="true" />
    <field name="item_barcodes" type="string" indexed="true" stored="true" multiValued="true" docValues="true" />
    <field name="item_barcodes_search" type="string_punct_stop" indexed="true" stored="false" multiValued="true" />
    <field name="preferred_barcode" type="string" indexed="false" stored="true" />
    <field name="access_facet" type="string" indexed="true" stored="true" multiValued="true" docValues="true" />
    <field name="building_facet" type="string" indexed="true" stored="true" multiValued="true" />
    <!-- barcode -|- lib -|- location -|- lopped_callnum -|- shelfkey -|- reverse_shelfkey -|- full_callnum -|- callnum_show_sort  -->
    <field name="item_display" type="string" indexed="false" stored="true" multiValued="true" />

    <!-- lib -|- location -|- note -|- holdings summary -|- last received  -->
    <field name="mhld_display" type="string" indexed="false" stored="true" multiValued="true" />

    <!-- Digital Bookplates fields -->
    <!-- fund_code -|- druid -|- filename -|- long fund code text  -->
    <field name="bookplates_display" type="string" indexed="false" stored="true" multiValued="true" />
    <!-- Druid of the fund bookplate -->
    <field name="fund_facet" type="string" indexed="true" stored="true" multiValued="true" />

    <!-- Location facet -->
    <field name="location_facet" type="string" indexed="true" stored="true" multiValued="true" />


    <!-- Course Reserve Fields -->
    <field name="crez_course_id_search" type="textNoStem" indexed="true" stored="true" multiValued="true" />
    <field name="crez_course_name_search" type="textNoStem" indexed="true" stored="true" multiValued="true" />
    <field name="crez_instructor_search" type="textNoStem" indexed="true" stored="true" multiValued="true" />
    <!--  instructor, course facet field names are exposed to end users in SW -->
    <field name="instructor" type="string" indexed="true" stored="true" multiValued="true" />
    <field name="course" type="string" indexed="true" stored="true" multiValued="true" />
    <!-- crez_course_info is a facet and display field at this time (2012-03-21) -->
    <field name="crez_course_info" type="string" indexed="true" stored="true" multiValued="true" />
    <!-- the next two facets are not used in SW at this time -->
    <field name="crez_dept_facet" type="string" indexed="true" stored="true" multiValued="true" />
    <field name="crez_desk_facet" type="string" indexed="true" stored="true" multiValued="true" />

    <!-- *************** additional fields for DOR objects  ****************** -->
    <field name="druid" type="string_punct_stop" indexed="true" stored="true" />
    <field name="modsxml" type="string" indexed="false" stored="true" large="true" />
    <!-- collection (facet and display): "sirsi" or, for DOR items, the id of their parent coll -->
    <field name="collection" type="string" indexed="true" stored="true" multiValued="true" omitNorms="true" docValues="true"/>
    <!-- collection_with_title: easy way to indicate item's parent coll title in UI (may be deprecated in future) -->
    <field name="collection_with_title" type="string" indexed="false" stored="true" multiValued="true" />
    <!-- collection_search: allow searching within collections for aggr. colls -->
    <field name="collection_search" type="string_punct_stop" indexed="true" stored="true" multiValued="true" omitNorms="true" />
    <!-- display_type: used by UI code, e.g. 'file' or 'image' -->
    <!-- display_type can be removed after all DOR objects and MARC records are reindexed in Feb/March 2016 -->
    <field name="display_type" type="string" indexed="true" stored="true" multiValued="true" omitNorms="true" />
    <!--  used to determine when something is a digital collection -->
    <field name="collection_type" type="string" indexed="true" stored="true" multiValued="true" />
    <!-- file_id:  ids of files (including images) in the digital stacks -->
    <field name="file_id" type="string" indexed="false" stored="true" multiValued="true"/>
    <!-- set (facet and display): for DOR items that are part of a virtual objects, the id of their virtual object -->
    <field name="set" type="string" indexed="true" stored="true" multiValued="true" omitNorms="true" />
    <!-- set_with_title: easy way to indicate item's virtual object title in UI -->
    <field name="set_with_title" type="string" indexed="false" stored="true" multiValued="true" />


    <field name="uuid_ssi" type="string" indexed="true" stored="true" multiValued="false" docValues="true" />
    <field name="hashed_id_ssi" type="string" indexed="true" stored="true" multiValued="false" docValues="true" />
    <field name="building_location_facet_ssim" type="string" indexed="false" stored="true" docValues="true" multiValued="true" />

    <!-- *************** dynamic field types  ****************** -->
    <!--
    <dynamicField name="*_unstem_search" type="textNoStem" stored="true" indexed="true" multiValued="true" />
    <dynamicField name="*_search" type="text" stored="true" indexed="true" multiValued="true" />
    <dynamicField name="*_facet" type="string" stored="true" indexed="true" multiValued="true" />
    <dynamicField name="*_display" type="string" stored="true" indexed="false" multiValued="true"/>
-->
    <dynamicField name="*_si" type="string" stored="true" indexed="true" omitNorms="true" />
    <dynamicField name="*_sim" type="string" stored="true" indexed="true" multiValued="true" omitNorms="true" />
    <dynamicField name="*_ss" type="string" stored="true" indexed="false" omitNorms="true" />
    <dynamicField name="*_ssm" type="string" stored="true" indexed="false" multiValued="true" omitNorms="true" />
    <dynamicField name="*_ssi" type="string" stored="true" indexed="true" omitNorms="true" />
    <dynamicField name="*_ssim" type="string" stored="true" indexed="true" multiValued="true" omitNorms="true" />
    <dynamicField name="*_isi" type="tint" stored="true" indexed="true" omitNorms="true" />
    <dynamicField name="*_isim" type="tint" stored="true" indexed="true" multiValued="true" omitNorms="true" />
    <dynamicField name="*_sort" type="alphaSort" stored="true" indexed="true"/>
    <dynamicField name="*_xml" type="string" stored="true" indexed="false" omitNorms="true" />
    <dynamicField name="cjk_*" type="text_cjk" stored="false" indexed="true" multiValued="true" />
    <dynamicField name="cjk_exact_search_*" type="text_cjk_anchored" stored="false" indexed="true" multiValued="true" />
    <dynamicField name="ja_*" type="text_ja" indexed="true" stored="false" multiValued="true" />
    <dynamicField name="ko_*" type="text_ko" indexed="true" stored="false" multiValued="true" />
    <dynamicField name="*_hsim" type="string_hierarch" stored="true" indexed="true" multiValued="true" />
    <dynamicField name="*_struct" type="string" stored="true" indexed="false" multiValued="true" omitNorms="true" />
    <dynamicField name="*_dtsi" type="date" stored="true" indexed="false" omitNorms="true" />
  </fields>

  <!-- copy fields -->
  <copyField source="id" dest="id_search" />
  <copyField source="collection" dest="collection_search" />
  <copyField source="pub_date" dest="pub_date_search" />
  <copyField source="db_az_subject" dest="db_az_subject_search" />
  <copyField source="barcode_search" dest="item_barcodes_search" />
  <copyField source="barcode_search" dest="item_barcodes" />
  <!-- unstemmed and anchored search fields: title -->
  <copyField source="title_245a_search" dest="title_245a_exact_search" />
  <copyField source="title_245a_search" dest="title_245a_unstem_search" />
  <copyField source="title_245_search" dest="title_245_unstem_search" />
  <copyField source="title_uniform_search" dest="title_uniform_unstem_search" />
  <copyField source="title_variant_search" dest="title_variant_unstem_search" />
  <copyField source="title_related_search" dest="title_related_unstem_search" />
  <copyField source="author_title_search" dest="author_title_unstem_search" />
  <copyField source="author_title_245ac_search" dest="author_title_245ac_unstem_search" />
  <copyField source="author_title_1xx_search" dest="author_title_1xx_unstem_search" />
  <!-- unstemmed search fields: author -->
  <copyField source="author_1xx_search" dest="author_1xx_unstem_search" />
  <copyField source="author_7xx_search" dest="author_7xx_unstem_search" />
  <copyField source="author_8xx_search" dest="author_8xx_unstem_search" />
  <!-- unstemmed search fields: subject -->
  <copyField source="topic_search" dest="topic_unstem_search" />
  <copyField source="topic_subx_search" dest="topic_subx_unstem_search" />
  <copyField source="geographic_search" dest="geographic_unstem_search" />
  <copyField source="geographic_subz_search" dest="geographic_subz_unstem_search" />
  <copyField source="subject_other_search" dest="subject_other_unstem_search" />
  <copyField source="subject_other_subvy_search" dest="subject_other_subvy_unstem_search" />
  <copyField source="subject_all_search" dest="subject_all_unstem_search" />
  <!-- unstemmed search fields: toc/summary -->
  <copyField source="toc_search" dest="toc_unstem_search" />
  <copyField source="context_search" dest="context_unstem_search" />
  <copyField source="summary_search" dest="summary_unstem_search" />
  <!--  other unstemmed search fields -->
  <copyField source="series_search" dest="series_unstem_search" />
  <copyField source="all_search" dest="all_unstem_search" />
  <copyField source="bib_search" dest="bib_unstem_search" />

  <!-- course reserve fields -->
  <copyField source="crez_instructor_search" dest="instructor" />
  <copyField source="crez_course_id_search" dest="course" />

  <!-- image fields -->
  <copyField source="topic_search" dest="topic_display" />
  <copyField source="subject_other_search" dest="subject_other_display" />
  <copyField source="title_variant_search" dest="title_variant_display" />
  <copyField source="summary_search" dest="summary_display" />
  <copyField source="pub_search" dest="pub_display" />

  <!-- CJK fields -->
  <!-- both bigrams and unigrams in same field -->
  <copyField source="vern_title_245a_search" dest="cjk_title_245a_search" />
  <copyField source="vern_title_245_search" dest="cjk_title_245_search" />
  <copyField source="vern_title_245a_search" dest="cjk_exact_search_title_245a" />
  <copyField source="vern_title_uniform_search" dest="cjk_title_uniform_search" />
  <copyField source="vern_title_variant_search" dest="cjk_title_variant_search" />
  <copyField source="vern_title_related_search" dest="cjk_title_related_search" />
  <copyField source="vern_series_search" dest="cjk_series_search" />
  <copyField source="vern_author_1xx_search" dest="cjk_author_1xx_search" />
  <copyField source="vern_author_7xx_search" dest="cjk_author_7xx_search" />
  <copyField source="vern_author_8xx_search" dest="cjk_author_8xx_search" />
  <copyField source="vern_topic_search" dest="cjk_topic_search" />
  <copyField source="vern_topic_subx_search" dest="cjk_topic_subx_search" />
  <copyField source="vern_geographic_search" dest="cjk_geographic_search" />
  <copyField source="vern_geographic_subz_search" dest="cjk_geographic_subz_search" />
  <copyField source="vern_subject_other_search" dest="cjk_subject_other_search" />
  <copyField source="vern_subject_other_subvy_search" dest="cjk_subject_other_subvy_search" />
  <copyField source="vern_subject_all_search" dest="cjk_subject_all_search" />
  <copyField source="vern_pub_search" dest="cjk_pub_search" />
  <copyField source="vern_physical" dest="cjk_physical_search" />
  <copyField source="vern_toc_search" dest="cjk_toc_search" />
  <copyField source="vern_context_search" dest="cjk_context_search" />
  <copyField source="vern_summary_search" dest="cjk_summary_search" />
  <copyField source="vern_all_search" dest="cjk_all_search" />
  <copyField source="vern_bib_search" dest="cjk_bib_search" />
  <copyField source="vern_author_title_245ac_search" dest="cjk_author_title_245ac_search" />
  <copyfield source="vern_author_title_1xx_search" dest="cjk_vern_author_title_1xx_search" />

  <!-- Japanese fields -->
  <copyField source="vern_title_245a_search" dest="ja_title_245a_search" />
  <copyField source="vern_title_245_search" dest="ja_title_245_search" />
  <copyField source="vern_title_uniform_search" dest="ja_title_uniform_search" />
  <copyField source="vern_title_variant_search" dest="ja_title_variant_search" />
  <copyField source="vern_title_related_search" dest="ja_title_related_search" />
  <copyField source="vern_series_search" dest="ja_series_search" />
  <copyField source="vern_author_1xx_search" dest="ja_author_1xx_search" />
  <copyField source="vern_author_7xx_search" dest="ja_author_7xx_search" />
  <copyField source="vern_author_8xx_search" dest="ja_author_8xx_search" />
  <copyField source="vern_topic_search" dest="ja_topic_search" />
  <copyField source="vern_topic_subx_search" dest="ja_topic_subx_search" />
  <copyField source="vern_geographic_search" dest="ja_geographic_search" />
  <copyField source="vern_geographic_subz_search" dest="ja_geographic_subz_search" />
  <copyField source="vern_subject_other_search" dest="ja_subject_other_search" />
  <copyField source="vern_subject_other_subvy_search" dest="ja_subject_other_subvy_search" />
  <copyField source="vern_subject_all_search" dest="ja_subject_all_search" />
  <copyField source="vern_pub_search" dest="ja_pub_search" />
  <copyField source="vern_physical" dest="ja_physical_search" />
  <copyField source="vern_toc_search" dest="ja_toc_search" />
  <copyField source="vern_context_search" dest="ja_context_search" />
  <copyField source="vern_summary_search" dest="ja_summary_search" />
  <copyField source="vern_all_search" dest="ja_all_search" />
  <copyField source="vern_bib_search" dest="ja_bib_search" />
  <copyField source="vern_author_title_245ac_search" dest="ja_author_title_245ac_search" />
  <copyfield source="vern_author_title_1xx_search" dest="ja_vern_author_title_1xx_search" />

  <!-- Korean fields -->
  <copyField source="vern_title_245a_search" dest="ko_title_245a_search" />
  <copyField source="vern_title_245_search" dest="ko_title_245_search" />
  <copyField source="vern_title_uniform_search" dest="ko_title_uniform_search" />
  <copyField source="vern_title_variant_search" dest="ko_title_variant_search" />
  <copyField source="vern_title_related_search" dest="ko_title_related_search" />
  <copyField source="vern_series_search" dest="ko_series_search" />
  <copyField source="vern_author_1xx_search" dest="ko_author_1xx_search" />
  <copyField source="vern_author_7xx_search" dest="ko_author_7xx_search" />
  <copyField source="vern_author_8xx_search" dest="ko_author_8xx_search" />
  <copyField source="vern_topic_search" dest="ko_topic_search" />
  <copyField source="vern_topic_subx_search" dest="ko_topic_subx_search" />
  <copyField source="vern_geographic_search" dest="ko_geographic_search" />
  <copyField source="vern_geographic_subz_search" dest="ko_geographic_subz_search" />
  <copyField source="vern_subject_other_search" dest="ko_subject_other_search" />
  <copyField source="vern_subject_other_subvy_search" dest="ko_subject_other_subvy_search" />
  <copyField source="vern_subject_all_search" dest="ko_subject_all_search" />
  <copyField source="vern_pub_search" dest="ko_pub_search" />
  <copyField source="vern_physical" dest="ko_physical_search" />
  <copyField source="vern_toc_search" dest="ko_toc_search" />
  <copyField source="vern_context_search" dest="ko_context_search" />
  <copyField source="vern_summary_search" dest="ko_summary_search" />
  <copyField source="vern_all_search" dest="ko_all_search" />
  <copyField source="vern_bib_search" dest="ko_bib_search" />
  <copyField source="vern_author_title_245ac_search" dest="ko_author_title_245ac_search" />
  <copyfield source="vern_author_title_1xx_search" dest="ko_vern_author_title_1xx_search" />

  <types>
    <fieldType name="string" class="solr.StrField" sortMissingLast="true" />
    <fieldType name="boolean" class="solr.BoolField" sortMissingLast="true" />
    <fieldType name="binary" class="solr.BinaryField"/>
    <fieldType name="int" class="solr.IntPointField" />
    <fieldType name="float" class="solr.FloatPointField" />
    <fieldType name="long" class="solr.LongPointField" />
    <fieldType name="double" class="solr.DoublePointField"/>
    <fieldType name="date" class="solr.DatePointField" />
    <!-- t fields are for accelerating range queries -->
    <fieldType name="tint" class="solr.IntPointField" />
    <fieldType name="tfloat" class="solr.FloatPointField" />
    <fieldType name="tlong" class="solr.LongPointField" />
    <fieldType name="tdouble" class="solr.DoublePointField"/>
    <fieldType name="tdate" class="solr.DatePointField" />
    <fieldType name="random" class="solr.RandomSortField" indexed="true" />

    <!-- Analyzed Text, general case -->
    <fieldtype name="text" class="solr.TextField" positionIncrementGap="10000" autoGeneratePhraseQueries="true">
      <analyzer type="index">
        <!-- remove stand-alone punctuation, which gets dropped by the WDGF but an empty hole is left in the position and screws up phrase searches -->
        <charFilter class="solr.PatternReplaceCharFilterFactory" pattern="\s+(\p{Punct}+)\s+" replacement=" " />
        <tokenizer class="solr.WhitespaceTokenizerFactory" />
        <filter class="solr.ICUFoldingFilterFactory"/>  <!-- NFKC, case folding, diacritics removed -->
        <filter class="solr.SynonymGraphFilterFactory" synonyms="synonyms.txt" ignoreCase="true" expand="false"/>
        <filter class="solr.WordDelimiterGraphFilterFactory"
          splitOnCaseChange="1" generateWordParts="1" catenateWords="1"
          splitOnNumerics="0" generateNumberParts="1" catenateNumbers="1"
          catenateAll="0" preserveOriginal="0" stemEnglishPossessive="1" />
        <filter class="solr.FlattenGraphFilterFactory"/>
        <filter class="solr.SnowballPorterFilterFactory" language="English"/>
        <filter class="solr.RemoveDuplicatesTokenFilterFactory" />
      </analyzer>
      <analyzer type="query">
        <charFilter class="solr.PatternReplaceCharFilterFactory" pattern="\s+(\p{Punct}+)\s+" replacement=" " />
        <tokenizer class="solr.WhitespaceTokenizerFactory" />
        <filter class="solr.ICUFoldingFilterFactory"/>  <!-- NFKC, case folding, diacritics removed -->
        <filter class="solr.SynonymGraphFilterFactory" synonyms="synonyms.txt" ignoreCase="true" expand="false"/>
        <filter class="solr.WordDelimiterGraphFilterFactory"
          splitOnCaseChange="1" generateWordParts="1" catenateWords="1"
          splitOnNumerics="0" generateNumberParts="1" catenateNumbers="1"
          catenateAll="0" preserveOriginal="0" stemEnglishPossessive="1" />
        <filter class="solr.SnowballPorterFilterFactory" language="English"/>
        <filter class="solr.RemoveDuplicatesTokenFilterFactory" />
      </analyzer>
    </fieldtype>

    <!-- Analyzed Text, no Stemming -->
    <fieldtype name="textNoStem" class="solr.TextField" positionIncrementGap="10000" autoGeneratePhraseQueries="true">
      <analyzer type="index">
        <charFilter class="solr.PatternReplaceCharFilterFactory" pattern="\s+(\p{Punct}+)\s+" replacement=" " />
        <tokenizer class="solr.WhitespaceTokenizerFactory" />
        <filter class="solr.ICUFoldingFilterFactory"/>  <!-- NFKC, case folding, diacritics removed -->
        <filter class="solr.SynonymGraphFilterFactory" synonyms="synonyms.txt" ignoreCase="true" expand="false"/>
        <filter class="solr.WordDelimiterGraphFilterFactory"
          splitOnCaseChange="1" generateWordParts="1" catenateWords="1"
          splitOnNumerics="0" generateNumberParts="1" catenateNumbers="1"
          catenateAll="0" preserveOriginal="0" stemEnglishPossessive="0" />
        <filter class="solr.FlattenGraphFilterFactory"/>
      </analyzer>
      <analyzer type="query">
        <charFilter class="solr.PatternReplaceCharFilterFactory" pattern="\s+(\p{Punct}+)\s+" replacement=" " />
        <tokenizer class="solr.WhitespaceTokenizerFactory" />
        <filter class="solr.ICUFoldingFilterFactory"/>  <!-- NFKC, case folding, diacritics removed -->
        <filter class="solr.SynonymGraphFilterFactory" synonyms="synonyms.txt" ignoreCase="true" expand="false"/>
        <filter class="solr.WordDelimiterGraphFilterFactory"
          splitOnCaseChange="1" generateWordParts="1" catenateWords="1"
          splitOnNumerics="0" generateNumberParts="1" catenateNumbers="1"
          catenateAll="0" preserveOriginal="0" stemEnglishPossessive="0" />
      </analyzer>
    </fieldtype>

    <!-- Left and Right Anchored Analyzed Text, no Stemming -->
    <fieldtype name="text_anchored" class="solr.TextField" positionIncrementGap="10000" autoGeneratePhraseQueries="true">
      <analyzer type="index">
        <charFilter class="solr.PatternReplaceCharFilterFactory" pattern="\s+(\p{Punct}+)\s+" replacement=" " />
        <!-- put beginning and ending anchors on field value, removing trailing chars -->
        <!-- watch out for query time whitespace separated chars that will be processed as their own token stream, e.g. in 'felines : warm and fuzzy' -->
        <charFilter class="solr.PatternReplaceCharFilterFactory" pattern="^\s*(.*[\S&amp;&amp;[^\.\,\-:;/=&lt;&gt;\(\)\[\]\&amp;\|]])[\s\.\,\-:;/=&lt;&gt;\(\)\[\]\&amp;\|]*$" replacement="aaaaaa$1zzzzzz"/>
        <tokenizer class="solr.WhitespaceTokenizerFactory" />
        <filter class="solr.ICUFoldingFilterFactory"/>  <!-- NFKC, case folding, diacritics removed -->
        <filter class="solr.SynonymGraphFilterFactory" synonyms="synonyms.txt" ignoreCase="true" expand="false"/>
        <filter class="solr.SynonymGraphFilterFactory" synonyms="synonyms_both_anchors.txt" ignoreCase="true" expand="true"/>
        <filter class="solr.SynonymGraphFilterFactory" synonyms="synonyms_left_anchor.txt" ignoreCase="true" expand="true"/>
        <filter class="solr.SynonymGraphFilterFactory" synonyms="synonyms_right_anchor.txt" ignoreCase="true" expand="true"/>
        <filter class="solr.WordDelimiterGraphFilterFactory"
          splitOnCaseChange="1" generateWordParts="1" catenateWords="1"
          splitOnNumerics="0" generateNumberParts="1" catenateNumbers="1"
          catenateAll="0" preserveOriginal="0" stemEnglishPossessive="1" />
        <filter class="solr.FlattenGraphFilterFactory"/>
      </analyzer>
      <analyzer type="query">
        <charFilter class="solr.PatternReplaceCharFilterFactory" pattern="\s+(\p{Punct}+)\s+" replacement=" " />
        <!-- put beginning and ending anchors on field value, removing trailing chars -->
        <!-- watch out for query time whitespace separated chars that will be processed as their own token stream, e.g. in 'felines : warm and fuzzy' -->
        <charFilter class="solr.PatternReplaceCharFilterFactory" pattern="^\s*(.*[\S&amp;&amp;[^\.\,\-:;/=&lt;&gt;\(\)\[\]\&amp;\|]])[\s\.\,\-:;/=&lt;&gt;\(\)\[\]\&amp;\|]*$" replacement="aaaaaa$1zzzzzz"/>
        <tokenizer class="solr.WhitespaceTokenizerFactory" />
        <filter class="solr.ICUFoldingFilterFactory"/>  <!-- NFKC, case folding, diacritics removed -->
        <filter class="solr.SynonymGraphFilterFactory" synonyms="synonyms.txt" ignoreCase="true" expand="false"/>
        <filter class="solr.SynonymGraphFilterFactory" synonyms="synonyms_both_anchors.txt" ignoreCase="true" expand="true"/>
        <filter class="solr.SynonymGraphFilterFactory" synonyms="synonyms_left_anchor.txt" ignoreCase="true" expand="true"/>
        <filter class="solr.SynonymGraphFilterFactory" synonyms="synonyms_right_anchor.txt" ignoreCase="true" expand="true"/>
        <filter class="solr.WordDelimiterGraphFilterFactory"
          splitOnCaseChange="1" generateWordParts="1" catenateWords="1"
          splitOnNumerics="0" generateNumberParts="1" catenateNumbers="1"
          catenateAll="0" preserveOriginal="0" stemEnglishPossessive="1" />
      </analyzer>
    </fieldtype>

    <fieldtype name="text_cjk" class="solr.TextField" positionIncrementGap="10000" autoGeneratePhraseQueries="false">
     <analyzer>
        <!-- remove spaces among hangul and han chars if there is at least one hangul char -->
        <!-- a korean char guaranteed at the start of the pattern:  pattern="(\p{Hangul}\p{Han}*)\s+(?=[\p{Hangul}\p{Han}])" -->
        <charFilter class="solr.PatternReplaceCharFilterFactory" pattern="([\p{InHangul_Jamo}\p{InHangul_Compatibility_Jamo}\p{InHangul_Syllables}][\p{InBopomofo}\p{InBopomofo_Extended}\p{InCJK_Compatibility}\p{InCJK_Compatibility_Forms}\p{InCJK_Compatibility_Ideographs}\p{InCJK_Compatibility_Ideographs_Supplement}\p{InCJK_Radicals_Supplement}\p{InCJK_Symbols_And_Punctuation}\p{InCJK_Unified_Ideographs}\p{InCJK_Unified_Ideographs_Extension_A}\p{InCJK_Unified_Ideographs_Extension_B}\p{InKangxi_Radicals}\p{InHalfwidth_And_Fullwidth_Forms}\p{InIdeographic_Description_Characters}]*)\s+(?=[\p{InHangul_Jamo}\p{InHangul_Compatibility_Jamo}\p{InHangul_Syllables}\p{InBopomofo}\p{InBopomofo_Extended}\p{InCJK_Compatibility}\p{InCJK_Compatibility_Forms}\p{InCJK_Compatibility_Ideographs}\p{InCJK_Compatibility_Ideographs_Supplement}\p{InCJK_Radicals_Supplement}\p{InCJK_Symbols_And_Punctuation}\p{InCJK_Unified_Ideographs}\p{InCJK_Unified_Ideographs_Extension_A}\p{InCJK_Unified_Ideographs_Extension_B}\p{InKangxi_Radicals}\p{InHalfwidth_And_Fullwidth_Forms}\p{InIdeographic_Description_Characters}])" replacement="$1"/>
        <!-- a korean char guaranteed at the end of the pattern:    pattern="([\p{Hangul}\p{Han}])\s+(?=[\p{Han}\s]*\p{Hangul})" -->
        <charFilter class="solr.PatternReplaceCharFilterFactory" pattern="([\p{InHangul_Jamo}\p{InHangul_Compatibility_Jamo}\p{InHangul_Syllables}\p{InBopomofo}\p{InBopomofo_Extended}\p{InCJK_Compatibility}\p{InCJK_Compatibility_Forms}\p{InCJK_Compatibility_Ideographs}\p{InCJK_Compatibility_Ideographs_Supplement}\p{InCJK_Radicals_Supplement}\p{InCJK_Symbols_And_Punctuation}\p{InCJK_Unified_Ideographs}\p{InCJK_Unified_Ideographs_Extension_A}\p{InCJK_Unified_Ideographs_Extension_B}\p{InKangxi_Radicals}\p{InHalfwidth_And_Fullwidth_Forms}\p{InIdeographic_Description_Characters}])\s+(?=[\p{InBopomofo}\p{InBopomofo_Extended}\p{InCJK_Compatibility}\p{InCJK_Compatibility_Forms}\p{InCJK_Compatibility_Ideographs}\p{InCJK_Compatibility_Ideographs_Supplement}\p{InCJK_Radicals_Supplement}\p{InCJK_Symbols_And_Punctuation}\p{InCJK_Unified_Ideographs}\p{InCJK_Unified_Ideographs_Extension_A}\p{InCJK_Unified_Ideographs_Extension_B}\p{InKangxi_Radicals}\p{InHalfwidth_And_Fullwidth_Forms}\p{InIdeographic_Description_Characters}\s]*[\p{InHangul_Jamo}\p{InHangul_Compatibility_Jamo}\p{InHangul_Syllables}])" replacement="$1"/>
        <charFilter class="edu.stanford.lucene.analysis.ICUCustomTransformCharFilterFactory" id="edu/stanford/lucene/analysis/stanford_cjk_transliterations.txt" />
        <charFilter class="edu.stanford.lucene.analysis.ICUTransformCharFilterFactory" id="Traditional-Simplified" />
        <charFilter class="edu.stanford.lucene.analysis.ICUTransformCharFilterFactory" id="Katakana-Hiragana" />
        <charFilter class="solr.PatternReplaceCharFilterFactory"
          pattern="([\p{InHiragana}\p{InKatakana}\p{InKatakana_Phonetic_Extensions}])([^\p{InHiragana}\p{InKatakana}\p{InKatakana_Phonetic_Extensions}])"
          replacement="$1 $2"
        />
        <tokenizer class="solr.ICUTokenizerFactory" />
        <filter class="solr.CJKWidthFilterFactory"/>
        <filter class="solr.ICUFoldingFilterFactory"/>   <!-- NFKC, case folding, diacritics removed -->
        <filter class="solr.CJKBigramFilterFactory" han="false" hiragana="false" katakana="false" hangul="true" outputUnigrams="true" />
      </analyzer>
    </fieldtype>

    <!-- Left and Right Anchored Analyzed CJK Text -->
    <fieldType name="text_cjk_anchored"  class="solr.TextField" positionIncrementGap="10000" autoGeneratePhraseQueries="false">
      <analyzer>
        <charFilter class="solr.PatternReplaceCharFilterFactory" pattern="\s+(\p{Punct}+)\s+" replacement=" " />
        <!-- put beginning and ending anchors on field value, removing trailing chars -->
        <!-- watch out for query time whitespace separated chars that will be processed as their own token stream, e.g. in 'felines : warm and fuzzy' -->
        <charFilter class="solr.PatternReplaceCharFilterFactory" pattern="^\s*(.*[\S&amp;&amp;[^\.\,\-:;/=&lt;&gt;\(\)\[\]\&amp;\|]])[\s\.\,\-:;/=&lt;&gt;\(\)\[\]\&amp;\|]*$" replacement="aaaaaa$1zzzzzz"/>
        <charFilter class="edu.stanford.lucene.analysis.ICUCustomTransformCharFilterFactory" id="edu/stanford/lucene/analysis/stanford_cjk_transliterations.txt" />
        <charFilter class="edu.stanford.lucene.analysis.ICUTransformCharFilterFactory" id="Traditional-Simplified" />
        <charFilter class="edu.stanford.lucene.analysis.ICUTransformCharFilterFactory" id="Katakana-Hiragana" />
        <!-- replace all whitespace to improve boosting when the metadata and query were entered with slightly different spacing -->
        <charFilter class="solr.PatternReplaceCharFilterFactory" pattern="\s+" replacement="" />
        <tokenizer class="solr.WhitespaceTokenizerFactory" />
        <filter class="solr.CJKWidthFilterFactory"/>
        <filter class="solr.ICUFoldingFilterFactory"/>  <!-- NFKC, case folding, diacritics removed -->
      </analyzer>
    </fieldType>

    <!-- Japanese using morphological analysis (see text_cjk for a configuration using bigramming)

           NOTE: If you want to optimize search for precision, use default operator AND in your request
           handler config (q.op) Use OR if you would like to optimize for recall (default).
      -->

    <fieldType name="text_ja" class="solr.TextField" positionIncrementGap="100" autoGeneratePhraseQueries="false">
      <analyzer>
        <!-- Kuromoji Japanese morphological analyzer/tokenizer (JapaneseTokenizer)

           Kuromoji has a search mode (default) that does segmentation useful for search.  A heuristic
           is used to segment compounds into its parts and the compound itself is kept as synonym.

           Valid values for attribute mode are:
              normal: regular segmentation
              search: segmentation useful for search with synonyms compounds (default)
            extended: same as search mode, but unigrams unknown words (experimental)

           For some applications it might be good to use search mode for indexing and normal mode for
           queries to reduce recall and prevent parts of compounds from being matched and highlighted.
           Use <analyzer type="index"> and <analyzer type="query"> for this and mode normal in query.

           Kuromoji also has a convenient user dictionary feature that allows overriding the statistical
           model with your own entries for segmentation, part-of-speech tags and readings without a need
           to specify weights.  Notice that user dictionaries have not been subject to extensive testing.

           User dictionary attributes are:
                     userDictionary: user dictionary filename
             userDictionaryEncoding: user dictionary encoding (default is UTF-8)

           See lang/userdict_ja.txt for a sample user dictionary file.

           Punctuation characters are discarded by default.  Use discardPunctuation="false" to keep them.
        -->
        <!-- drop all strings that contain Hangul, because they are probably Korean and shouldn't get analyzed as Japanese -->
        <charFilter class="solr.PatternReplaceCharFilterFactory" pattern="^.*[\p{InHangul_Jamo}\p{InHangul_Compatibility_Jamo}\p{InHangul_Syllables}].*$" replacement=""/>
        <!-- only select strings that contain some kana; this is a really poor attempt at only parsing Japanese text, and preferably we could identify it during indexing instead;
            fortunately, for our current purposes, strings with kana are the ones we're particularly concerned with and the cjk_* fields will do well enough with Kanji-only values
        -->
        <charFilter class="solr.PatternReplaceCharFilterFactory" pattern="^(.*[\p{InHiragana}\p{InKatakana}\p{InKatakana_Phonetic_Extensions}].*)|(.*)$" replacement="$1"/>
        <charFilter class="edu.stanford.lucene.analysis.ICUTransformCharFilterFactory" id="Hiragana-Katakana" />
        <tokenizer class="solr.JapaneseTokenizerFactory" mode="search"/>
        <!--<tokenizer class="solr.JapaneseTokenizerFactory" mode="search" userDictionary="lang/userdict_ja.txt"/>-->
        <!-- Reduces inflected verbs and adjectives to their base/dictionary forms (è¾æ›¸å½¢) -->
        <filter class="solr.JapaneseBaseFormFilterFactory"/>
        <!-- Removes tokens with certain part-of-speech tags -->
        <filter class="solr.JapanesePartOfSpeechStopFilterFactory" tags="stoptags_ja.txt" />
        <!-- Normalizes full-width romaji to half-width and half-width kana to full-width (Unicode NFKC subset) -->
        <filter class="solr.CJKWidthFilterFactory"/>
        <!-- Local customization, at the moment we are not interested in using ja stopwords -->
        <!-- Removes common tokens typically not useful for search, but have a negative effect on ranking -->
        <!-- <filter class="solr.StopFilterFactory" ignoreCase="true" words="lang/stopwords_ja.txt" /> -->
        <!-- Normalizes common katakana spelling variations by removing any last long sound character (U+30FC) -->
        <filter class="solr.JapaneseKatakanaStemFilterFactory" minimumLength="4"/>
        <!-- Lower-cases romaji characters -->
        <filter class="solr.LowerCaseFilterFactory"/>
      </analyzer>
    </fieldType>

    <!-- Korean morphological analysis -->
    <fieldType name="text_ko" class="solr.TextField" positionIncrementGap="100">
      <analyzer>
        <!-- only select strings that contain some Hangul; this is a really poor attempt at only parsing Korean text, and preferably we could identify it during indexing instead;
          fortunately, for our current purposes, strings with hangul are the ones we're particularly concerned with and the cjk_* fields will do well enough with Kanji-only values
      -->
      <charFilter class="solr.PatternReplaceCharFilterFactory" pattern="^(.*[\p{InHangul_Jamo}\p{InHangul_Compatibility_Jamo}\p{InHangul_Syllables}].*)|(.*)$" replacement="$1"/>
        <!-- Nori Korean morphological analyzer/tokenizer (KoreanTokenizer)
          The Korean (nori) analyzer integrates Lucene nori analysis module into Solr.
          It uses the mecab-ko-dic dictionary to perform morphological analysis of Korean texts.
          This dictionary was built with MeCab, it defines a format for the features adapted
          for the Korean language.
          Nori also has a convenient user dictionary feature that allows overriding the statistical
          model with your own entries for segmentation, part-of-speech tags and readings without a need
          to specify weights. Notice that user dictionaries have not been subject to extensive testing.
          The tokenizer supports multiple schema attributes:
            * userDictionary: User dictionary path.
            * userDictionaryEncoding: User dictionary encoding.
            * decompoundMode: Decompound mode. Either 'none', 'discard', 'mixed'. Default is 'discard'.
            * outputUnknownUnigrams: If true outputs unigrams for unknown words.
        -->
        <tokenizer class="solr.KoreanTokenizerFactory" decompoundMode="discard" outputUnknownUnigrams="false"/>
        <!-- Removes some part of speech stuff like EOMI (Pos.E), you can add a parameter 'tags',
          listing the tags to remove. By default it removes:
          E, IC, J, MAG, MAJ, MM, SP, SSC, SSO, SC, SE, XPN, XSA, XSN, XSV, UNA, NA, VSV
          This is basically an equivalent to stemming.
        -->
        <filter class="solr.KoreanPartOfSpeechStopFilterFactory" />
        <!-- Replaces term text with the Hangul transcription of Hanja characters, if applicable: -->
        <filter class="solr.KoreanReadingFormFilterFactory" />
        <filter class="solr.LowerCaseFilterFactory" />
      </analyzer>
    </fieldType>

    <!-- single token analyzed text, for sorting.  Punctuation is significant. -->
    <fieldtype name="alphaSort" class="solr.TextField" sortMissingLast="true" omitNorms="true">
      <analyzer>
        <tokenizer class="solr.KeywordTokenizerFactory" />
        <filter class="solr.ICUFoldingFilterFactory"/>
        <filter class="solr.TrimFilterFactory" />
      </analyzer>
    </fieldtype>

    <!-- single token with punctuation terms removed so dismax doesn't look for punctuation terms in these fields -->
    <!-- On client side, Lucene query parser breaks things up by whitespace *before* field analysis for dismax -->
    <!-- so punctuation terms (& : ;) are stopwords to allow results from other fields when these chars are surrounded by spaces in query -->
    <!--  do not lowercase -->
    <fieldType name="string_punct_stop" class="solr.TextField" omitNorms="true">
      <analyzer type="index">
        <tokenizer class="solr.KeywordTokenizerFactory" />
        <filter class="solr.ICUNormalizer2FilterFactory" name="nfkc" mode="compose" />
      </analyzer>
      <analyzer type="query">
        <tokenizer class="solr.KeywordTokenizerFactory" />
        <filter class="solr.ICUNormalizer2FilterFactory" name="nfkc" mode="compose" />
        <!-- removing punctuation for Lucene query parser issues -->
        <filter class="solr.StopFilterFactory" ignoreCase="true" words="stopwords_punctuation.txt" />
      </analyzer>
    </fieldType>

    <!-- field designed for LC call number searching -->
    <fieldType name="callnum_ws" class="solr.TextField" omitNorms="true" positionIncrementGap="100" autoGeneratePhraseQueries="true">
      <analyzer type="index">
        <!-- LC: no space between class letters and digits; normalize to " ." before first cutter, no leading space -->
        <charFilter class="solr.PatternReplaceCharFilterFactory" pattern="^ *([A-Za-z]{1,3}) ?(\d{1,4}(\.\d+)?) ?\.?([A-Za-z]\d+)" replacement="$1$2 .$4"/>
        <!-- LC: add space between first cutter letter and its digits to allow matching on first cutter letter only -->
        <charFilter class="solr.PatternReplaceCharFilterFactory" pattern="^([A-Za-z]{1,3}\d{1,4}(\.\d+)? \.([A-Za-z]))(\d+)" replacement="$1 $4"/>
        <!-- prepend yyyy to string so searches can be left anchored -->
        <charFilter class="solr.PatternReplaceCharFilterFactory" pattern="^\s*(\S{1})" replacement="yyyy$1"/>
        <tokenizer class="solr.WhitespaceTokenizerFactory" />
        <filter class="solr.LowerCaseFilterFactory" />
      </analyzer>
      <!-- Note that the query string could be a partial call number, so we can't combine all patterns -->
      <analyzer type="query">
        <!-- LC: no space between class letters and digits, no leading space -->
        <charFilter class="solr.PatternReplaceCharFilterFactory" pattern="^ *([A-Za-z]{1,3}) *(\d{1,4})" replacement="$1$2" />
        <!-- LC: normalize to " ." before first cutter or first letter of cutter (could be preceded by " ." "." " " or nothing) -->
        <charFilter class="solr.PatternReplaceCharFilterFactory" pattern="^([A-Za-z]{1,3}\d{1,4}(\.\d+)?) *\.?([A-Za-z](\d+)?)" replacement="$1 .$3" />
        <!-- LC: add space between first cutter letter and its digits to allow matching on first cutter letter only -->
        <charFilter class="solr.PatternReplaceCharFilterFactory" pattern="^([A-Za-z]{1,3}\d{1,4}(\.\d+)? \.([A-Za-z]))([^ ])" replacement="$1 $4"/>
        <!-- prepend yyyy to string so searches can be left anchored -->
        <charFilter class="solr.PatternReplaceCharFilterFactory" pattern="^\s*(\S{1})" replacement="yyyy$1"/>
        <tokenizer class="solr.WhitespaceTokenizerFactory" />
	      <filter class="solr.LowerCaseFilterFactory" />
      </analyzer>
    </fieldType>

    <!-- for hierarchical facets
       a query for Books/NonFic will match documents indexed with values like
        Books/NonFic, Books/NonFic/Law, Books/NonFic/Science/Physics, etc.
       But it will not match documents indexed with values like Books, or Books/Fic...
     -->
    <fieldType name="string_hierarch" class="solr.TextField" positionIncrementGap="100">
      <analyzer type="index">
        <tokenizer class="solr.PathHierarchyTokenizerFactory" delimiter="|" />
      </analyzer>
      <analyzer type="query">
        <tokenizer class="solr.KeywordTokenizerFactory" />
      </analyzer>
    </fieldType>

  </types>

</schema>
